server.port=9090
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.reactor.netty=DEBUG
logging.level.org.springdoc=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=DEBUG

# ============================================
# CONFIGURACIÓN DE MICROSERVICIOS Y SEGURIDAD
# ============================================

# URL del microservicio de usuarios (para el enrutamiento)
api-gw.url-microservicio-usuarios=http://users-service:9091

# JWK Set URI de Keycloak para validación de tokens
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://keycloak:8080/realms/tesina/protocol/openid-connect/certs

# ============================================
# ENRUTAMIENTO (SPRING CLOUD GATEWAY)
# ============================================

# Ruta principal para el API de usuarios
spring.cloud.gateway.routes[0].id=usuarios-service
spring.cloud.gateway.routes[0].uri=${api-gw.url-microservicio-usuarios}
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/usuarios/**, /api/auth/**

# Ruta para la documentación OpenAPI del servicio de usuarios
spring.cloud.gateway.routes[1].id=usuarios-docs
spring.cloud.gateway.routes[1].uri=${api-gw.url-microservicio-usuarios}
spring.cloud.gateway.routes[1].predicates[0]=Path=/v3/api-docs/usuarios
spring.cloud.gateway.routes[1].filters[0]=RewritePath=/v3/api-docs/usuarios, /v3/api-docs
spring.cloud.gateway.routes[1].filters[1]=RemoveRequestHeader=Authorization


# ============================================
# CONFIGURACIÓN DE SWAGGER UI
# ============================================

# Habilitar Swagger UI en el gateway
springdoc.swagger-ui.enabled=true

# Configurar URLs de las APIs de los microservicios
springdoc.swagger-ui.urls[0].name=Users Service
springdoc.swagger-ui.urls[0].url=/v3/api-docs/usuarios

# Deshabilitar la generación de docs del gateway (solo agrega microservicios)
springdoc.api-docs.enabled=false

# ============================================
# OTROS
# ============================================

# Actuator
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.health.defaults.enabled=true

# Rate limiting
app.rate-limit.default-capacity=20
app.rate-limit.default-refill-tokens=10
app.rate-limit.routes[/api/usuarios/create].capacity=10
app.rate-limit.routes[/api/usuarios/create].refill-tokens=5
app.rate-limit.routes[/api/usuarios/list/**].capacity=40
app.rate-limit.routes[/api/usuarios/list/**].refill-tokens=20