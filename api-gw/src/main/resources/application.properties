server.port=9090
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.org.springframework.web.reactive=DEBUG
logging.level.reactor.netty=DEBUG
spring.cloud.gateway.httpserver.wiretap=false
spring.cloud.gateway.httpclient.wiretap=false
spring.config.encoding=UTF-8

# URL de microservicios
api-gw.url-microservicio-usuarios=http://users-service:9091

# JWK Set URI de Keycloak (realm tesina)
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://keycloak:8080/realms/tesina/protocol/openid-connect/certs

# Rate limiting por defecto (para todas las rutas)
app.rate-limit.default-capacity=20
app.rate-limit.default-refill-tokens=10

# Rate limiting personalizado por ruta
# Crear usuario: más estricto (5 requests por segundo)
app.rate-limit.routes[/api/usuarios/create].capacity=10
app.rate-limit.routes[/api/usuarios/create].refill-tokens=5

# Listar usuarios: más permisivo (20 requests por segundo)
app.rate-limit.routes[/api/usuarios/list/**].capacity=40
app.rate-limit.routes[/api/usuarios/list/**].refill-tokens=20

# Actuator endpoints
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.health.defaults.enabled=true

# ===== CONFIGURACIÓN DE SWAGGER/OPENAPI =====

# Habilitar OpenAPI en el Gateway
springdoc.api-docs.enabled=true
springdoc.api-docs.path=/v3/api-docs

# Configurar Swagger UI
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha

# CRÍTICO: Configurar la lista de URLs de documentación
springdoc.swagger-ui.urls[0].name=Users Service
springdoc.swagger-ui.urls[0].url=/usuarios-docs

# CRÍTICO: URL por defecto que se muestra al abrir Swagger
springdoc.swagger-ui.url=/usuarios-docs

# Configuración adicional de Swagger
springdoc.swagger-ui.config-url=/v3/api-docs/swagger-config
springdoc.swagger-ui.display-request-duration=true
springdoc.swagger-ui.try-it-out-enabled=true

# Logging adicional para debug
logging.level.org.springframework.cloud.gateway.route.RouteDefinitionRouteLocator=DEBUG
logging.level.org.springdoc=DEBUG